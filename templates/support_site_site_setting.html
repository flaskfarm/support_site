{% extends "base.html" %}
{% block content %}

{{ macros.m_button_group([['globalSettingSaveBtn', '설정 저장']])}}
{{ macros.m_row_start('5') }}
{{ macros.m_row_end() }}

<nav>
  {{ macros.m_tab_head_start() }}
  {{ macros.m_tab_head('daum', 'Daum', true) }}
    {{ macros.m_tab_head('wavve', '웨이브', false) }}
    {{ macros.m_tab_head('tving', '티빙', false) }}
    {{ macros.m_tab_head('naver', '네이버 API', false) }}
  {{ macros.m_tab_head_end() }}
</nav>

<form id='setting' name='setting'>
<div class="tab-content" id="nav-tabContent">
{{ macros.m_tab_content_start('daum', true) }}
  {{ macros.setting_input_text('site_daum_cookie', 'Cookie', value=arg['site_daum_cookie'],  desc=['TIARA=값 만 입력']) }}
  {{ macros.setting_checkbox('site_daum_use_proxy', 'Proxy 사용', value=arg['site_daum_use_proxy'], desc=None) }}
  <div id="site_daum_use_proxy_div" class="collapse">
  {{ macros.setting_input_text('site_daum_proxy_url', 'Proxy URL', value=arg['site_daum_proxy_url']) }}
  </div>
  <!--
  {{ macros.m_hr() }}
  {{ macros.setting_input_text_and_buttons('site_daum_test', 'Test', [['site_daum_test_btn', 'Test']], value=arg['site_daum_test'],  desc=['영화 or 방송제목']) }}
  -->
{{ macros.m_tab_content_end() }}

{{ macros.m_tab_content_start('wavve', false) }}
  {{ macros.setting_input_textarea('site_wavve_credential', 'Credential', value=arg['site_wavve_credential'], row='3') }}
  {{ macros.setting_checkbox('site_wavve_use_proxy', 'Proxy 사용', value=arg['site_wavve_use_proxy'], desc=None) }}
  <div id="site_wavve_use_proxy_div" class="collapse">
    {{ macros.setting_input_text('site_wavve_proxy_url', 'Proxy URL', value=arg['site_wavve_proxy_url'], desc=None) }}
  </div>
{{ macros.m_tab_content_end() }} 

{{ macros.m_tab_content_start('tving', false) }}
  {{ macros.setting_radio_with_value('site_tving_login_type', '로그인 타입', [['cjone', 'CJONE'], ['tving', 'TVING']], value=arg['site_tving_login_type']) }}
  {{ macros.setting_input_text('site_tving_id', 'ID', value=arg['site_tving_id'], col='3') }}
  {{ macros.setting_input_text_and_buttons('site_tving_pw', '암호', [['site_tving_login_btn', '토큰 가져오기']], value=arg['site_tving_pw'], col='6') }}
  {{ macros.setting_input_text_and_buttons('site_tving_token', '토큰', [['site_tving_deviceid_btn', 'DeviceID 목록 가져오기']], value=arg['site_tving_token'], col='8', desc=['계정 정보대신 이 값을 사용합니다.', '이 값을 수동으로 넣는 경우 계정정보를 입력할 필요가 없습니다.', '_tving_token=XXXXXX 형식']) }}
  {{ macros.setting_input_text('site_tving_deviceid', 'Device ID', value=arg['site_tving_deviceid'], col='3', desc=['model이 PC인 항목의 uuid 값 입력']) }}
  {{ macros.setting_checkbox('site_tving_use_proxy', 'Proxy 사용', value=arg['site_tving_use_proxy'], desc=None) }}
  <div id="site_tving_use_proxy_div" class="collapse">
    {{ macros.setting_input_text('site_tving_proxy_url', 'Proxy URL', value=arg['site_tving_proxy_url'], desc=None) }}
  </div>
{{ macros.m_tab_content_end() }}

{{ macros.m_tab_content_start('naver', false) }}
  {{ macros.setting_input_textarea('site_naver_key', '네이버 API', value=arg['site_naver_key'], row='10', desc=['여러 개의 키값을 지원합니다. 구분자 엔터', '파파고 번역 키와 중복 사용 가능', '예)', 'Client_ID_1,Client_Secret_1','Client_ID_2,Client_Secret_2']) }}
{{ macros.m_tab_content_end() }}
</form>
</div>



<script type="text/javascript">

$(document).ready(function(){
  use_collapse("site_daum_use_proxy");
  use_collapse("site_wavve_use_proxy");
  use_collapse("site_tving_use_proxy");
});

$('#site_daum_use_proxy').change(function() {
  use_collapse('site_daum_use_proxy');
});

$('#site_wavve_use_proxy').change(function() {
  use_collapse('site_wavve_use_proxy');
});

$('#site_tving_use_proxy').change(function() {
  use_collapse('site_tving_use_proxy');
});


$("body").on('click', '#site_tving_login_btn', function(e) {
  e.preventDefault(); 
  globalSendCommand('tving_login', $('#site_tving_id').val(), $('#site_tving_pw').val(), $('#site_tving_login_type0').val(), function(ret){
    if (ret['ret'] == 'success')
      $("#site_tving_token").val(ret['token']);
  });
});

$("body").on('click', '#site_tving_deviceid_btn', function(e) {
  e.preventDefault(); 
  globalSendCommand('tving_deviceid', $('#site_tving_token').val(), null, null, function(ret){

  });
});

</script>    
{% endblock %}